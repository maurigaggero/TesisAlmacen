@page "/caja"
@inject CajaService CajaService
@inject NavigationManager NavigationManager
@inject UsuarioService UsuarioService
@inject IJSRuntime JS

<div class="d-flex justify-content-between mb-1" id="header">
    <h3>Caja</h3>
    <div>
        <a href="caja/abrir" class="btn btn-sm btn-success">
            <i class="oi oi-check"></i> Abrir Nueva Caja
        </a>
    </div>
</div>

@if (caja != null)
{
    <table class="table table-hover">
        <thead class="thead thead-dark">
            <tr>
                <th>Fecha</th>
                <th>Empleado</th>
                <th>Monto Apertura</th>
                <th>Monto Cierre</th>
                <th>Cierre de Caja</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>@caja.Fecha.ToString("dd/MM/yyyy")</td>
                <td>@caja.Empleado.Nombre</td>
                <td>@caja.Apertura</td>
                <td>@caja.Cierre</td>
                <td>
                    <a class="btn btn-sm btn-danger" href="caja/cerrar/@caja.Id"><i class="oi oi-delete"></i></a>
                </td>
            </tr>
        </tbody>
    </table>
}


@code {
    private CajaModel caja { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var result = await UsuarioService.GetSesion();
        if (result == null)
        {
            NavigationManager.NavigateTo("/");
        }
        else
        {
            caja = await CajaService.GetUltimo();
        }
    }
}